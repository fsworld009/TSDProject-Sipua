<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>RTCtest</title>
        <script type="text/javascript" src="recorder.js"> </script>
		<script type="text/javascript">
        
		//Callback when requesting audio input stream
        var rawData;
        //var 
        var recorder;
		function gotStream(stream) {
            var context = new webkitAudioContext();
            var mediaStreamSource = context.createMediaStreamSource(stream);
            recorder = new Recorder(mediaStreamSource);
            recorder.record();
			//window.AudioContext = window.AudioContext || window.webkitAudioContext;
			//var audioContext = new AudioContext();

			//Create an AudioNode from the stream.
			//var mediaStreamSource = audioContext.createMediaStreamSource( stream );

			//Connect it to the destination to hear yourself or other node for processing
			//mediaStreamSource.connect( audioContext.destination );
		}
        var micConstraints = {audio:true};
		navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia;
		navigator.getUserMedia( micConstraints, gotStream );
        
        function test(buffer){
            console.log("test"+buffer);
        }

		</script>
	</head>
	<body>
		<div style="float:left"> 
		<p><a href="#" onClick="recorder.getBuffer(test)">TEST</a></p>
		</div>
	</body>
</html>